FROM node:9.3.0-alpine

RUN mkdir -p /usr/src/app

ENV NODE_PATH=/node_modules
ENV PATH=$PATH:/node_modules/.bin

WORKDIR /usr/src/app

COPY client/yarn.lock ./yarn.lock
COPY client/package.json ./package.json
COPY client/tsconfig.json ./tsconfig.json
COPY client/tslint.json ./tslint.json
COPY client/config ./config
COPY client/scripts ./scripts

RUN yarn

EXPOSE 3000
EXPOSE 35729

ADD docker/react/docker-entrypoint.sh /usr/local/bin/docker-entrypoint.sh
RUN chmod 777 /usr/local/bin/docker-entrypoint.sh
ENTRYPOINT ["/usr/local/bin/docker-entrypoint.sh"]
CMD ["start"]